## 简介

* uniapp-scaffold（studio-scaffold） 是一款基于Vue 2. x的跨平台小程序脚手架及插拔式模板，提供超过 20+个（基于微信视觉规范）基础和业务组件，包含自定义 request 请求库、utils、theme 主题、vuex全局数据管理、国际化配置等于一体的插拔式应用框架，可快速落地业务。

### 特点：

* **全：** 组件和工具库齐全，积木式开发并输出各端小程序（主要方向） + h5 + app
* **简：** 一套 code，Vue 2. x 写法，上手成本低，可快速撸业务页面

### Who's using it（可在对应 App 内搜索或扫码欣赏）

* Keep 运动助手

| 仓库 | 百度版 | 头条版  | 微信版 |
| - | - | - | - |
| 内网 | <img src="https://images.mepai.me/app/works/38224/2020-04-16/w_5e97cc922f0fa/15e97cc922f2c0.jpg!1200w.jpg" width="220" /> | <img src="https://images.mepai.me/app/works/38224/2020-04-16/w_5e97cc922f0fa/25e97cc922f254.jpg!1200w.jpg" width="220" /> | <img src="https://images.mepai.me/app/works/38224/2020-04-16/w_5e97cc922f0fa/05e97cc922f30c.jpg!1200w.jpg" width="220" /> |

* Asako Studio：

浅子艺术工作室，一个致力于视觉影像与工程研究的实验室、工作室（以下微信扫码或搜一搜）

| Miniprogram  | Home | Creative | Works | About |
| - | - | - | - | - |
| <img src="http://imglf5.nosdn0.126.net/img/eCsxeXUwR1dBeGU1UlRYV2liZmI2NXQ3WmpvbmxORk85Uk1oVFppSDFJcHlmYWlLUVd5ajdnPT0.jpg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> | <img src="http://imglf5.nosdn0.126.net/img/eCsxeXUwR1dBeGVpcXBRdVlkRko5cUJtQnRIbXFaaDZLV3dNY3FENGtyaWtmTDFhN3BFOHV3PT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> | <img src="http://imglf6.nosdn0.126.net/img/eCsxeXUwR1dBeGVpcXBRdVlkRko5cXdsbXQzZ1prWFpFNG1nVzhEcTc2T2ZaQzJWeVhsUHNRPT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> | <img src="http://imglf4.nosdn0.126.net/img/eCsxeXUwR1dBeGVpcXBRdVlkRko5cjEzbStSbFRZSko1MVZvMTk5cTJLR1UvWWh1ZXlVQkJnPT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> | <img src="http://imglf5.nosdn0.126.net/img/eCsxeXUwR1dBeGZWRXM5Z0NjSUJzTVJnbHNsYWUvbzBwaW5LSGZhcGJ4SnhDVXV5aFMwbXBnPT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> |

* 浅子影报：

一页日历 • 精美壁纸库 RSS

AI 精选全球视觉与摄影艺术，伴你每天好心情 🌞

| Miniprogram | Home | About | Wallpaper Detail | AI 日报 |
| - | - | - | - | - |
| <img src="http://imglf3.nosdn0.126.net/img/eCsxeXUwR1dBeGNsdE9SVWdXZHNxRGdDelZVL0l1aEYxSXdQT1JzMHV3SlVlYmlETXU5WHl3PT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /><br/><img src="http://imglf3.nosdn0.126.net/img/eCsxeXUwR1dBeGNsdE9SVWdXZHNxRkJSSGYrWTdyM0pwcWZvNDNkVU1uVDkwbm9SSFJYL25nPT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> | <img src="http://imglf3.nosdn0.126.net/img/eCsxeXUwR1dBeGNsdE9SVWdXZHNxQmlVejBzYXRtQzFsd1QrSjRMMlB6K1JjRldScm1aWDlRPT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> | <img src="http://imglf4.nosdn0.126.net/img/eCsxeXUwR1dBeGZWRXM5Z0NjSUJzSmY4aHFmTWtGMmZPQWgwWmlsMzhOODFobDBzU1VrNE9nPT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> | <img src="http://imglf5.nosdn0.126.net/img/eCsxeXUwR1dBeGNsdE9SVWdXZHNxREVNQzZpRGg1TUxGWkhEYkZBblZ2M2VnMnFtbGNZb0dBPT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> | <img src="http://imglf6.nosdn0.126.net/img/eCsxeXUwR1dBeGNsdE9SVWdXZHNxS3VjS3JSa1RKN1lWUHJ4dGcwTVYydjVXMEVjYm1UbFl3PT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /><br/><img src="http://imglf6.nosdn0.126.net/img/eCsxeXUwR1dBeGNsdE9SVWdXZHNxS0E1RGZVYkxuZWkvQjVnc2RGT2FYcG9zYnJFMDNIUUZBPT0.jpeg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" width="180" /> |

* 浅子居家：智能生活，从家开始 🏡

* Asako UED：一款集齐才华（规范）与颜值（专业）的用户体验设计语言

* 更多补充中

### Guides | 参考资料

* [uni-app 文档](https://uniapp.dcloud.io)
* [微信小程序文档](https://developers.weixin.qq.com/miniprogram/dev/framework)
* [头条小程序文档](https://microapp.bytedance.com/dev/cn/mini-app/develop/framework/basic-reference/introduction)
* [百度小程序文档](https://smartprogram.baidu.com/docs/develop/fuctionlist/list/)
* [支付宝小程序文档](https://opendocs.alipay.com/mini/developer)
* [airbnb javascript standard](https://github.com/airbnb/javascript)
* [Ant Design introduce](https://ant.design/docs/spec/introduce-cn)
* [JD Front-End Coding Guidelines](https://guide.aotu.io)
* [Taro · React 系小程序及多端统一开发解决方案](https://taro.aotu.io)

### Dev | 开发姿势

cd projectName => git clone 此项目 => 基于此项目开发;

一：主包模式

1. 工具，先下载各平台开发工具（IDE）https://uniapp.dcloud.io/quickstart

2. 在 Hbuilder 中导入当前项目（uni-app 类型），修改或更新当前配置，manifest.json 和 pages.json（尤其注意要添加对应平台的 appid，在开发者后台配置 request、downloadFile 域名）;

3. 配置插件，菜单栏点击插件管理可以安装当前项目所需要的插件和 loader，（scss、babel、es6 等），yarn（步骤 3 不分先后）;

4. 菜单栏点击运行到要开发的小程序平台，不习惯当前 IDE 的可以切换到 VS Code，同步开发，实时编译;

5. 进入各家开发者后台，提审，发布（也可以基于 miniprogram-cli 对接各家小程序平台实现自动构建上传）

6. 更多补充中

二：子包模式

默认小程序：yarn dev:mp-weixin 

h5：yarn dev:h5 

更多平台：mp-alipy、mp-baidu、mp-toutiao等 

备注：注意不同渠道小程序要更新manifest.json里的mp-weixin appid

### Publish | 发布

一：主包模式

1. 点击菜单“发行”，到对应小程序平台；

二：子包模式

1. vue.config.js里已配置相关环境产物路径（景区和出行渠道不同）

2. ~~main.js里runtime相关逻辑代码注释（仅出行渠道注释，已动态引入runtime模块，忽略此步骤）~~

3. 编译不同渠道产物（--subpackage选项默认已在脚本里拼接，升级后不用）
- 景区小程序：yarn build:mp-weixin

4. 不同渠道打tag或发包

备注：npm run均可以换成yarn使用，2021-03后HbuilderX工具内支持发行子包/插件模式


### Structure

``` 
├── src                      # main project
│ ├── /config/               # 业务基础/全局/国际化/皮肤配置等
│ ├── /components/           # 公共组件库: 基础 + 部分高复用业务组件
│ ├── /pages/                # 主要业务页面（index.vue + index.scss）
│ ├── /services/             # 服务Service，建议按照业务模块拆分
│ ├── /styles/               # 全局样式 => core + mixin + function + theme...
│ ├── /store/                # 数据流（globalApp、业务数据等）
│ ├── /mixins/               # 全局或子模块混入，自动绑定在Vue实例上
│ ├── /static/               # 项目图片、图标、字体及静态资源CDN、tabBar等
│ ├── /utils/                # lib、request、tool等
│ │──page.json               # 全局配置，类似app.json
│ │──manifest.json           # app配置
│ │──main.js                 # 全局入口js index
│ │──App.vue                 # 全局入口vue index
├── node_modules             # npm依赖包
├── miniprogram_npm          # 小程序npm包（不参与实时编译）
├── dist                     # 小程序npm包（不参与实时编译）
│ │──dev                     # 开发环境各种产物
│ │──build                   # 生产环境各种产物
```

### 组件 | UI 库

``` 
Asako UED
一款集才华（规范）与颜值（专业）的用户体验设计组件库（基于微信视觉规范进一步封装的组件)
全局组件（@/components目录下）已开启easycom模式，可以不用像传统vue组件那样安装、引用、注册，可以直接在业务中使用（tm-xxx）

* 基础组件
  + tm-button
  + tm-avatar
  + tm-icon
  + tm-badge
  + tm-mask（遮罩，可自定义slot content及position）
  + tm-tag
  + tm-tips
  + tm-actionsheet（浮动面板，支持更强大的配置和淡入淡出动画）
  + tm-card
  + tm-spin（支持svg、img、css loading）
  + tm-calender（日历）
  + tm-text-animate（文字渐变动画）
  + tm-countup（数字递增及动画）
  + tm-tree（树结构）

* 业务组件
  + tm-author（一条数据/一个作者的丰富场景，头像、title、描述、额外插槽等）
  + tm-skeleton（骨架屏）
  + tm-status（状态结果页）
  + tm-swiper（3D画廊幻灯片）
  + tm-sticky（滑动固定器）
  + tm-navbar（自定义导航栏）
  + tm-clock（计时器）
  + tm-interact（互动）
  + tm-map（个性化地图）
  + Poster（分享海报插件/wxcomponents/wxa-plugin-canvas）
  + more...

* 图表组件
  + tm-charts（支持个性化配置config/charts，类型支持折线图、柱状图、饼图等10+种）

// 使用方式
任何页面均可直接使用tm-xxx组件（已全局注入）
<template>
  <tm-icon type='home' size=36 color='#f00' />
</template>
```


### Services | 数据

``` 
// 使用方式

* services层（新建yourpage.js）

import config from "@/config";
import http from "@/utils/request";
const { request } = http;
/* request层做了统一api host拼接url，若覆盖只需自定义baseUrl或在config/index.js自定义hostKey，业务层传参使用 */

// 某推荐列表
export function getAlbumListSvc(query = {}) {
  return request({
    // hostKey: 'recommend' // @/config hosts下配置对应key（自定义host时推荐方式，优于baseUrl）
    // baseUrl: config.yourkey, // 自定义请求host，不指定会走默认api
    url: "/your-api-path",
    method: "post", // 'get'可省略
    data: {
      page: 1,
      size: 10
      ...query
    }
  });
}

* pages业务层

import * as Services from "@/services/home";
export default {
  data() {
    return {
      entry: []
    }
  },
  onLoad(options) {
    // 若需要参数可从options取然后传入query
    this.getAlbumList(query = {})
  },
  methods() {
    async getAlbumList() {
      let res = await Services.getAlbumListSvc();
      if(res.ok) {
          this.entry = res.data;
      }
    }
  }
}

```
### 注意事项

1. 使用 Vue. js 注意事项 https://uniapp.dcloud.io/use
2. 根据不同平台小程序做条件编译（非常重要）https://uniapp.dcloud.io/platform
3. 高级开发技巧 https://uniapp.dcloud.io/snippet
4. 性能优化建议 https://uniapp.dcloud.io/performance
5. 如果出现微信开发者工具启动后白屏的问题，检查是否启动多个微信开发者工具，如果是则关闭所有打开的微信开发者工具，然后再重新运行（注意 IDE 插件和编译 Loader 要安装，否则可能出现编译白屏的情况）
6. 可以通过微信开发者工具切换 pages.json 中 condition 配置的页面，或者关闭微信开发者工具，然后再从 HBuilderX 中启动指定页
7. 如遇到编译异常情况，如找不到npm依赖包，可能是npm安装路径有问题，建议检查node相关

#### 头条版

1. 视频 video 相关

* video 组件必须有高 height，不能是 min-height，否则 iOS 下播放有声音没视频

2. 样式相关

* iconfont 在字节跳动小程序组件内引入字体会失效，解决方式：[在 App. vue 内的 style 节点引入](https://github.com/dcloudio/uni-app/issues/553#issuecomment-511271165)

3. 自定义组件

* props 不能传引用，只能传值。子组件里修改了 props 对象里的属性，不会同步父组件

4. 网络相关

* JSON 返回中会遇到换行符导致解析失败，需要在 request 阶段过滤这几种换行符

### 升级日志
1. 脚手架初始化，支持27+自定义组件；


### 技术维护

mukuashi@icloud. com

### License

[MIT](http://opensource.org/licenses/MIT)
